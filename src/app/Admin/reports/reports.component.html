<app-navigation></app-navigation>
<div class="card">
  <h4 class="card-title">Reportes</h4>
  <button class="btn" 
          mat-button mat-raised-button color="primary" 
          (click)="descarga()">
          Descargar Excel
  </button>
  <div>
    <div class="d-flex justify-content-between px-5">

      <div>
        <h5>Técnico: {{ technician.forename }} {{ technician.surname }}</h5>
        <p>Email: {{ technician.email }}</p>
        <p>Total de tickets en el año 2022: {{ totalTickets }}</p>
      </div>

      <div style="display: block; width: 600px;">
        <canvas baseChart
          [data]="barChartData"
          [options]="barChartOptions"
          [plugins]="barChartPlugins"
          [type]="barChartType"
          (chartHover)="chartHovered($event)"
          (chartClick)="chartClicked($event)">
        </canvas>
      </div>
    </div>
  </div>
  <br><br>
  <div class='tableauPlaceholder' 
  id='viz1646362084957' 
  style='position: relative'>
  <object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='views&#47;CO2percpita_16426305355040&#47;Dashboard1?:language=es-ES&amp;:embed=true' /> <param name='toolbar' value='yes' /><param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='es-ES' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1646362084957');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.minWidth='1000px';vizElement.style.maxWidth='100%';vizElement.style.minHeight='850px';vizElement.style.maxHeight=(divElement.offsetWidth*0.75)+'px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.minWidth='1000px';vizElement.style.maxWidth='100%';vizElement.style.minHeight='850px';vizElement.style.maxHeight=(divElement.offsetWidth*0.75)+'px';} else { vizElement.style.width='100%';vizElement.style.minHeight='750px';vizElement.style.maxHeight=(divElement.offsetWidth*1.77)+'px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

 
  <iframe
    src="https://public.tableau.com/views/Esprezza/Dashboard1?:language=es-ES&:display_count=n&:origin=viz_share_link?:showVizHome=no&:embed=true"
    width="1000px"
    height="500px"
    pading="10px"
  ></iframe> 

  <br /><br />

